The optimal Python code for this problem is too long to be included here. Please refer to the LeetCode URL for the code.